# Comparing `tmp/poe_api-0.4.3-py3-none-any.whl.zip` & `tmp/poe_api-0.4.4-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,43 +1,44 @@
-Zip file size: 39457 bytes, number of entries: 41
--rw-r--r--  2.0 unx    19695 b- defN 23-May-31 05:27 poe.py
+Zip file size: 40859 bytes, number of entries: 42
+-rw-r--r--  2.0 unx    20965 b- defN 23-Jun-04 03:42 poe.py
 -rw-r--r--  2.0 unx     1093 b- defN 23-May-27 23:16 poe_graphql/AddHumanMessageMutation.graphql
--rw-r--r--  2.0 unx      373 b- defN 23-May-27 23:16 poe_graphql/AddMessageBreakMutation.graphql
+-rw-r--r--  2.0 unx      504 b- defN 23-Jun-04 03:20 poe_graphql/AddMessageBreakMutation.graphql
 -rw-r--r--  2.0 unx      180 b- defN 23-May-27 23:16 poe_graphql/AutoSubscriptionMutation.graphql
 -rw-r--r--  2.0 unx       97 b- defN 23-May-27 23:16 poe_graphql/BioFragment.graphql
 -rw-r--r--  2.0 unx       73 b- defN 23-May-27 23:16 poe_graphql/ChatAddedSubscription.graphql
 -rw-r--r--  2.0 unx      100 b- defN 23-May-27 23:16 poe_graphql/ChatFragment.graphql
--rw-r--r--  2.0 unx     6971 b- defN 23-May-27 23:16 poe_graphql/ChatListPaginationQuery.graphql
+-rw-r--r--  2.0 unx    11486 b- defN 23-Jun-04 03:16 poe_graphql/ChatListPaginationQuery.graphql
 -rw-r--r--  2.0 unx      686 b- defN 23-May-27 23:16 poe_graphql/ChatPaginationQuery.graphql
 -rw-r--r--  2.0 unx      154 b- defN 23-May-27 23:16 poe_graphql/ChatViewQuery.graphql
 -rw-r--r--  2.0 unx      160 b- defN 23-May-27 23:16 poe_graphql/DeleteHumanMessagesMutation.graphql
 -rw-r--r--  2.0 unx      123 b- defN 23-May-27 23:16 poe_graphql/DeleteMessageMutation.graphql
+-rw-r--r--  2.0 unx      146 b- defN 23-Jun-04 03:20 poe_graphql/DeleteUserMessagesMutation.graphql
 -rw-r--r--  2.0 unx     1083 b- defN 23-May-27 23:37 poe_graphql/ExploreBotsListPaginationQuery.graphql
 -rw-r--r--  2.0 unx      103 b- defN 23-May-27 23:16 poe_graphql/HandleFragment.graphql
 -rw-r--r--  2.0 unx      306 b- defN 23-May-27 23:16 poe_graphql/LoginWithVerificationCodeMutation.graphql
 -rw-r--r--  2.0 unx     1885 b- defN 23-May-27 23:16 poe_graphql/MessageAddedSubscription.graphql
 -rw-r--r--  2.0 unx      135 b- defN 23-May-27 23:16 poe_graphql/MessageDeletedSubscription.graphql
 -rw-r--r--  2.0 unx      194 b- defN 23-May-27 23:16 poe_graphql/MessageFragment.graphql
 -rw-r--r--  2.0 unx      145 b- defN 23-May-27 23:16 poe_graphql/MessageRemoveVoteMutation.graphql
 -rw-r--r--  2.0 unx      216 b- defN 23-May-27 23:16 poe_graphql/MessageSetVoteMutation.graphql
--rw-r--r--  2.0 unx     1670 b- defN 23-May-27 23:16 poe_graphql/PoeBotCreateMutation.graphql
--rw-r--r--  2.0 unx      841 b- defN 23-May-27 23:16 poe_graphql/PoeBotEditMutation.graphql
--rw-r--r--  2.0 unx      710 b- defN 23-May-27 23:16 poe_graphql/SendMessageMutation.graphql
+-rw-r--r--  2.0 unx     1666 b- defN 23-Jun-04 03:22 poe_graphql/PoeBotCreateMutation.graphql
+-rw-r--r--  2.0 unx      841 b- defN 23-Jun-04 03:23 poe_graphql/PoeBotEditMutation.graphql
+-rw-r--r--  2.0 unx      912 b- defN 23-Jun-04 03:19 poe_graphql/SendMessageMutation.graphql
 -rw-r--r--  2.0 unx      263 b- defN 23-May-27 23:16 poe_graphql/SendVerificationCodeForLoginMutation.graphql
 -rw-r--r--  2.0 unx      213 b- defN 23-May-27 23:16 poe_graphql/ShareMessagesMutation.graphql
 -rw-r--r--  2.0 unx      308 b- defN 23-May-27 23:16 poe_graphql/SignupWithVerificationCodeMutation.graphql
 -rw-r--r--  2.0 unx      159 b- defN 23-May-27 23:16 poe_graphql/StaleChatUpdateMutation.graphql
 -rw-r--r--  2.0 unx      162 b- defN 23-May-27 23:16 poe_graphql/SubscriptionsMutation.graphql
 -rw-r--r--  2.0 unx       95 b- defN 23-May-27 23:16 poe_graphql/SummarizePlainPostQuery.graphql
 -rw-r--r--  2.0 unx      147 b- defN 23-May-27 23:16 poe_graphql/SummarizeQuotePostQuery.graphql
 -rw-r--r--  2.0 unx      180 b- defN 23-May-27 23:16 poe_graphql/SummarizeSharePostQuery.graphql
 -rw-r--r--  2.0 unx      368 b- defN 23-May-27 23:16 poe_graphql/UserSnippetFragment.graphql
 -rw-r--r--  2.0 unx      400 b- defN 23-May-27 23:16 poe_graphql/ViewerInfoQuery.graphql
 -rw-r--r--  2.0 unx     1038 b- defN 23-May-27 23:16 poe_graphql/ViewerStateFragment.graphql
 -rw-r--r--  2.0 unx      657 b- defN 23-May-27 23:16 poe_graphql/ViewerStateUpdatedSubscription.graphql
 -rw-r--r--  2.0 unx        0 b- defN 23-May-27 23:16 poe_graphql/__init__.py
--rw-r--r--  2.0 unx    35149 b- defN 23-May-31 05:29 poe_api-0.4.3.dist-info/LICENSE
--rw-r--r--  2.0 unx    17489 b- defN 23-May-31 05:29 poe_api-0.4.3.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-31 05:29 poe_api-0.4.3.dist-info/WHEEL
--rw-r--r--  2.0 unx       16 b- defN 23-May-31 05:29 poe_api-0.4.3.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3866 b- defN 23-May-31 05:29 poe_api-0.4.3.dist-info/RECORD
-41 files, 97595 bytes uncompressed, 33083 bytes compressed:  66.1%
+-rw-r--r--  2.0 unx    35149 b- defN 23-Jun-04 03:47 poe_api-0.4.4.dist-info/LICENSE
+-rw-r--r--  2.0 unx    18099 b- defN 23-Jun-04 03:47 poe_api-0.4.4.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-04 03:47 poe_api-0.4.4.dist-info/WHEEL
+-rw-r--r--  2.0 unx       16 b- defN 23-Jun-04 03:47 poe_api-0.4.4.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3969 b- defN 23-Jun-04 03:47 poe_api-0.4.4.dist-info/RECORD
+42 files, 104568 bytes uncompressed, 34317 bytes compressed:  67.2%
```

## zipnote {}

```diff
@@ -30,14 +30,17 @@
 
 Filename: poe_graphql/DeleteHumanMessagesMutation.graphql
 Comment: 
 
 Filename: poe_graphql/DeleteMessageMutation.graphql
 Comment: 
 
+Filename: poe_graphql/DeleteUserMessagesMutation.graphql
+Comment: 
+
 Filename: poe_graphql/ExploreBotsListPaginationQuery.graphql
 Comment: 
 
 Filename: poe_graphql/HandleFragment.graphql
 Comment: 
 
 Filename: poe_graphql/LoginWithVerificationCodeMutation.graphql
@@ -102,23 +105,23 @@
 
 Filename: poe_graphql/ViewerStateUpdatedSubscription.graphql
 Comment: 
 
 Filename: poe_graphql/__init__.py
 Comment: 
 
-Filename: poe_api-0.4.3.dist-info/LICENSE
+Filename: poe_api-0.4.4.dist-info/LICENSE
 Comment: 
 
-Filename: poe_api-0.4.3.dist-info/METADATA
+Filename: poe_api-0.4.4.dist-info/METADATA
 Comment: 
 
-Filename: poe_api-0.4.3.dist-info/WHEEL
+Filename: poe_api-0.4.4.dist-info/WHEEL
 Comment: 
 
-Filename: poe_api-0.4.3.dist-info/top_level.txt
+Filename: poe_api-0.4.4.dist-info/top_level.txt
 Comment: 
 
-Filename: poe_api-0.4.3.dist-info/RECORD
+Filename: poe_api-0.4.4.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## poe.py

```diff
@@ -91,54 +91,72 @@
   return device_id
 
 class Client:
   gql_url = "https://poe.com/api/gql_POST"
   gql_recv_url = "https://poe.com/api/receive_POST"
   home_url = "https://poe.com"
   settings_url = "https://poe.com/api/settings"
-  
+
   def __init__(self, token, proxy=None, headers=headers, device_id=None, client_identifier=client_identifier):
+    self.ws_connecting = False
+    self.ws_connected = False
+    self.ws_error = False
+    self.connect_count = 0
+    self.setup_count = 0
+
+    self.token = token
     self.device_id = device_id
     self.proxy = proxy
-    
-    if client_identifier:
-      self.session = requests_tls.Session(client_identifier=client_identifier)
-    else:
-      self.session = requests.Session()
-        
-    if proxy:
-      self.session.proxies = {
-        "http": self.proxy,
-        "https": self.proxy
-      }
-      logger.info(f"Proxy enabled: {self.proxy}")
+    self.client_identifier = client_identifier
 
     self.active_messages = {}
     self.message_queues = {}
 
-    self.session.cookies.set("p-b", token, domain="poe.com")
     self.headers = {**headers, **{
       "Referrer": "https://poe.com/",
       "Origin": "https://poe.com",
       "Host": "poe.com",
       "Sec-Fetch-Dest": "empty",
       "Sec-Fetch-Mode": "cors",
       "Sec-Fetch-Site": "same-origin",
     }}
-    self.session.headers.update(self.headers)
 
-    self.setup_connection()
     self.connect_ws()
 
+  def setup_session(self):
+    logger.info("Setting up session...")
+    if self.client_identifier:
+      self.session = requests_tls.Session(client_identifier=self.client_identifier)
+    else:
+      self.session = requests.Session()
+
+    if self.proxy:
+      self.session.proxies = {
+        "http": self.proxy,
+        "https": self.proxy
+      }
+      logger.info(f"Proxy enabled: {self.proxy}")
+
+    self.session.cookies.set("p-b", self.token, domain="poe.com")
+    self.session.headers.update(self.headers)
+
   def setup_connection(self):
+    if self.setup_count % 5 == 0:
+      self.setup_session()
+
+    self.setup_count += 1
+
     self.ws_domain = f"tch{random.randint(1, 1e6)}"
     self.next_data = self.get_next_data(overwrite_vars=True)
     self.channel = self.get_channel_data()
-    self.bots = self.get_bots(download_next_data=False)
-    self.bot_names = self.get_bot_names()
+
+    if not hasattr(self, "bots"):
+      self.bots = self.get_bots(download_next_data=False)
+    if not hasattr(self, "bot_names"):
+      self.bot_names = self.get_bot_names()
 
     if self.device_id is None:
       self.device_id = self.get_device_id()
 
     self.gql_headers = {
       "poe-formkey": self.formkey,
       "poe-tchannel": self.channel["channel"],
@@ -327,44 +345,79 @@
         "proxy_type": proxy_parsed.scheme,
         "http_proxy_host": proxy_parsed.hostname,
         "http_proxy_port": proxy_parsed.port
       }
 
     self.ws.run_forever(**kwargs)
 
-  def connect_ws(self):
+  def connect_ws(self, timeout=5):
+    if self.ws_connected:
+      return
+
+    if self.ws_connecting:
+      while not self.ws_connected:
+        time.sleep(0.01)
+      return
+
+    self.ws_connecting = True
     self.ws_connected = False
-    self.ws = websocket.WebSocketApp(
-      self.get_websocket_url(), 
+
+    if self.connect_count % 5 == 0:
+      self.setup_connection()
+
+    self.connect_count += 1
+
+    ws = websocket.WebSocketApp(
+      self.get_websocket_url(),
       header={"User-Agent": user_agent},
       on_message=self.on_message,
       on_open=self.on_ws_connect,
       on_error=self.on_ws_error,
       on_close=self.on_ws_close
     )
+
+    self.ws = ws
+
     t = threading.Thread(target=self.ws_run_thread, daemon=True)
     t.start()
+
+    timer = 0
     while not self.ws_connected:
       time.sleep(0.01)
+      timer += 0.01
+      if timer > timeout:
+        self.ws_connecting = False
+        self.ws_connected = False
+        self.ws_error = True
+        ws.close()
+        raise RuntimeError("Timed out waiting for websocket to connect.")
   
   def disconnect_ws(self):
+    self.ws_connecting = False
+    self.ws_connected = False
     if self.ws:
       self.ws.close()
-    self.ws_connected = False
   
   def on_ws_connect(self, ws):
+    self.ws_connecting = False
     self.ws_connected = True
   
   def on_ws_close(self, ws, close_status_code, close_message):
-    self.ws_connected = False
     logger.warn(f"Websocket closed with status {close_status_code}: {close_message}")
+
+    self.ws_connecting = False
+    self.ws_connected = False
+    if self.ws_error:
+      self.ws_error = False
+      self.connect_ws()
   
   def on_ws_error(self, ws, error):
-    self.disconnect_ws()
-    self.connect_ws()
+    self.ws_connecting = False
+    self.ws_connected = False
+    self.ws_error = True
 
   def on_message(self, ws, msg):
     try:
       data = json.loads(msg)
 
       if not "messages" in data:
         return
@@ -401,22 +454,22 @@
       timer += 0.01
       if timer > timeout:
         raise RuntimeError("Timed out waiting for other messages to send.")
 
     # None indicates that a message is still in progress
     self.active_messages["pending"] = None
 
+    # reconnect websocket
+    while self.ws_error:
+      time.sleep(0.01)
+
+    self.connect_ws()
+
     logger.info(f"Sending message to {chatbot}: {message}")
 
-    # reconnect websocket
-    if not self.ws_connected:
-      self.disconnect_ws()
-      self.setup_connection()
-      self.connect_ws()
-    
     chat_id = self.get_bot_by_codename(chatbot)["chatId"]
     message_data = self.send_query("SendMessageMutation", {
       "bot": chatbot,
       "query": message,
       "chatId": chat_id,
       "source": None,
       "clientNonce": generate_nonce(),
@@ -585,9 +638,13 @@
     })
 
     data = result["data"]["poeBotEdit"]
     if data["status"] != "success":
       raise RuntimeError(f"Poe returned an error while trying to edit a bot: {data['status']}")
     self.get_bots()
     return data
+  
+  def purge_all_conversations(self):
+    logger.info("Purging all conversations")
+    self.send_query("DeleteUserMessagesMutation", {})
 
 load_queries()
```

## poe_graphql/AddMessageBreakMutation.graphql

```diff
@@ -1,17 +1,32 @@
-mutation AddMessageBreakMutation($chatId: BigInt!) {
-    messageBreakCreate(chatId: $chatId) {
-        message {
-            id
-            __typename
-            messageId
-            text
-            linkifiedText
-            authorNickname
-            state
-            vote
-            voteReason
-            creationTime
-            suggestedReplies
-        }
+mutation chatHelpers_addMessageBreakEdgeMutation_Mutation(
+  $chatId: BigInt!
+) {
+  messageBreakEdgeCreate(chatId: $chatId) {
+    message {
+      cursor
+      node {
+        id
+        messageId
+        text
+        author
+        suggestedReplies
+        creationTime
+        state
+      }
+      id
     }
+    introductionMessage {
+      cursor
+      node {
+        id
+        messageId
+        text
+        author
+        suggestedReplies
+        creationTime
+        state
+      }
+      id
+    }
+  }
 }
```

## poe_graphql/ChatListPaginationQuery.graphql

```diff
@@ -6,14 +6,18 @@
   node(id: $id) {
     __typename
     ...ChatPageMain_chat_1G22uz
     id
   }
 }
 
+fragment BotDefaultInfoCard_bot on Bot {
+  displayName
+}
+
 fragment BotImage_bot on Bot {
   displayName
   ...botHelpers_useDeletion_bot
   ...BotImage_useProfileImage_bot
 }
 
 fragment BotImage_useProfileImage_bot on Bot {
@@ -25,106 +29,218 @@
     ... on UrlBotImage {
       url
     }
   }
   ...botHelpers_useDeletion_bot
 }
 
+fragment BotInfoCardBody_bot on Bot {
+  description
+}
+
+fragment BotInfoCardFooter_bot on Bot {
+  poweredBy
+}
+
+fragment BotInfoCardHeader_bot on Bot {
+  displayName
+  ...BotImage_bot
+  ...IdAnnotation_node
+  creator {
+    ...UserHandle_user
+    id
+  }
+}
+
+fragment BotInfoCard_bot on Bot {
+  ...BotInfoCardHeader_bot
+  ...BotInfoCardBody_bot
+  ...BotInfoCardFooter_bot
+}
+
+fragment ChatBreakButton_chat on Chat {
+  defaultBotObject {
+    hasClearContext
+    id
+  }
+  ...chatHelpers_useSendChatBreak_chat
+}
+
+fragment ChatBreakButton_messageEdges on MessageEdge {
+  ...ChatBreakButton_useIsDisabled_messageEdges
+}
+
+fragment ChatBreakButton_useIsDisabled_messageEdges on MessageEdge {
+  node {
+    author
+    ...inputHelpers_useIsBotResponding_message
+    id
+  }
+}
+
 fragment ChatMessageDownvotedButton_message on Message {
   ...MessageFeedbackReasonModal_message
   ...MessageFeedbackOtherModal_message
 }
 
+fragment ChatMessageDropdownMenu_bot on Bot {
+  isApiBot
+  isPrivateBot
+  botId
+}
+
 fragment ChatMessageDropdownMenu_message on Message {
   id
   messageId
   vote
   text
   author
   ...chatHelpers_isBotMessage
 }
 
+fragment ChatMessageFeedbackButtons_bot on Bot {
+  isApiBot
+  isPrivateBot
+}
+
 fragment ChatMessageFeedbackButtons_message on Message {
   id
   messageId
   vote
   voteReason
   ...ChatMessageDownvotedButton_message
 }
 
-fragment ChatMessageInputView_chat on Chat {
+fragment ChatMessageInputContainer_chat on Chat {
   id
-  chatId
   defaultBotObject {
-    nickname
     messageLimit {
-      dailyBalance
-      shouldShowRemainingMessageCount
+      ...ChatMessageSendButton_messageLimit
     }
-    hasClearContext
     isDown
-    ...botHelpers_useDeletion_bot
+    ...ChatMessageTextArea_bot
+    ...ChatMessageInputContainer_useIsBotDisabled_bot
     id
   }
-  shouldShowDisclaimer
-  ...chatHelpers_useSendMessage_chat
-  ...chatHelpers_useSendChatBreak_chat
+  ...ChatMessageInputContainer_useSendMessage_chat
 }
 
-fragment ChatMessageInputView_edges on MessageEdge {
+fragment ChatMessageInputContainer_messageEdges on MessageEdge {
+  ...ChatMessageTextArea_messageEdges
   node {
-    ...chatHelpers_isChatBreak
-    ...chatHelpers_isHumanMessage
-    state
-    text
+    ...inputHelpers_useIsBotResponding_message
     id
   }
 }
 
+fragment ChatMessageInputContainer_useIsBotDisabled_bot on Bot {
+  isDown
+  ...botHelpers_useDeletion_bot
+}
+
+fragment ChatMessageInputContainer_useSendMessage_chat on Chat {
+  ...chatHelpers_useSendMessage_chat
+}
+
+fragment ChatMessageInputFooter_chat on Chat {
+  ...ChatBreakButton_chat
+  ...ChatMessageInputContainer_chat
+}
+
+fragment ChatMessageInputFooter_messageEdges on MessageEdge {
+  ...ChatBreakButton_messageEdges
+  ...ChatMessageInputContainer_messageEdges
+}
+
+fragment ChatMessageOverflowButton_bot on Bot {
+  ...ChatMessageDropdownMenu_bot
+}
+
 fragment ChatMessageOverflowButton_message on Message {
   text
   ...ChatMessageDropdownMenu_message
   ...chatHelpers_isBotMessage
 }
 
+fragment ChatMessageSendButton_MessageLimitTooltip_messageLimit on MessageLimit {
+  shouldShowRemainingMessageCount
+  dailyBalance
+}
+
+fragment ChatMessageSendButton_messageLimit on MessageLimit {
+  ...ChatMessageSendButton_MessageLimitTooltip_messageLimit
+}
+
 fragment ChatMessageSuggestedReplies_SuggestedReplyButton_chat on Chat {
   ...chatHelpers_useSendMessage_chat
 }
 
 fragment ChatMessageSuggestedReplies_SuggestedReplyButton_message on Message {
   messageId
 }
 
 fragment ChatMessageSuggestedReplies_chat on Chat {
   ...ChatWelcomeView_chat
   ...ChatMessageSuggestedReplies_SuggestedReplyButton_chat
   defaultBotObject {
     hasWelcomeTopics
+    hasSuggestedReplies
+    isApiBot
     id
   }
 }
 
 fragment ChatMessageSuggestedReplies_message on Message {
   suggestedReplies
   ...ChatMessageSuggestedReplies_SuggestedReplyButton_message
+  ...useIsMessageCancelled_message
+}
+
+fragment ChatMessageTextArea_bot on Bot {
+  ...ChatMessageTextArea_usePlaceholderText_bot
+}
+
+fragment ChatMessageTextArea_getLastHumanMessageText_messageEdge on MessageEdge {
+  node {
+    text
+    ...chatHelpers_isHumanMessage
+    id
+  }
+}
+
+fragment ChatMessageTextArea_messageEdges on MessageEdge {
+  ...ChatMessageTextArea_useOnKeyDown_messageEdges
+}
+
+fragment ChatMessageTextArea_useOnKeyDown_messageEdges on MessageEdge {
+  ...ChatMessageTextArea_getLastHumanMessageText_messageEdge
+}
+
+fragment ChatMessageTextArea_usePlaceholderText_bot on Bot {
+  displayName
 }
 
 fragment ChatMessage_chat on Chat {
   defaultBotObject {
     hasWelcomeTopics
     hasSuggestedReplies
     disclaimerText
-    messageLimit {
-      ...ChatPageRateLimitedBanner_messageLimit
-    }
+    displayName
+    messageTimeoutSecs
     ...ChatPageDisclaimer_bot
+    ...ChatPageRateLimitedBanner_bot
+    ...ChatMessageFeedbackButtons_bot
+    ...ChatMessageOverflowButton_bot
     id
   }
+  chatId
+  defaultBotNickname
   ...ChatMessageSuggestedReplies_chat
   ...ChatWelcomeView_chat
+  ...chatHelpers_useTimeoutLevel_chat
 }
 
 fragment ChatMessage_message on Message {
   id
   messageId
   text
   author
@@ -136,34 +252,56 @@
   ...ChatMessageOverflowButton_message
   ...chatHelpers_isHumanMessage
   ...chatHelpers_isBotMessage
   ...chatHelpers_isChatBreak
   ...chatHelpers_useTimeoutLevel
   ...MarkdownLinkInner_message
   ...IdAnnotation_node
+  ...useIsMessageCancelled_message
+}
+
+fragment ChatMessagesView_EmptyChat_chat on Chat {
+  defaultBotObject {
+    nickname
+    hasWelcomeTopics
+    ...BotInfoCard_bot
+    ...BotDefaultInfoCard_bot
+    ...ChatPageRateLimitedBanner_bot
+    id
+  }
+  ...ChatWelcomeView_chat
 }
 
 fragment ChatMessagesView_chat on Chat {
+  ...ChatMessagesView_EmptyChat_chat
   ...ChatMessage_chat
-  ...ChatWelcomeView_chat
   ...IdAnnotation_node
   defaultBotObject {
-    hasWelcomeTopics
-    messageLimit {
-      ...ChatPageRateLimitedBanner_messageLimit
-    }
+    ...BotInfoCard_bot
+    ...BotDefaultInfoCard_bot
+    nickname
     id
   }
 }
 
 fragment ChatMessagesView_edges on MessageEdge {
+  ...ChatMessagesView_useMessagePairs_edges
+  ...ChatStopMessageButton_edges
+  node {
+    ...chatHelpers_isBotMessage
+    id
+  }
+}
+
+fragment ChatMessagesView_useMessagePairs_edges on MessageEdge {
   node {
     id
     messageId
     creationTime
+    text
     ...ChatMessage_message
     ...chatHelpers_isBotMessage
     ...chatHelpers_isHumanMessage
     ...chatHelpers_isChatBreak
   }
 }
 
@@ -176,21 +314,21 @@
 }
 
 fragment ChatPageMainFooter_chat on Chat {
   defaultBotObject {
     ...ChatPageMainFooter_useAccessMessage_bot
     id
   }
-  ...ChatMessageInputView_chat
+  ...ChatMessageInputFooter_chat
   ...ChatPageShareFooter_chat
   ...ChatPageDeleteFooter_chat
 }
 
 fragment ChatPageMainFooter_edges on MessageEdge {
-  ...ChatMessageInputView_edges
+  ...ChatMessageInputFooter_messageEdges
 }
 
 fragment ChatPageMainFooter_useAccessMessage_bot on Bot {
   ...botHelpers_useDeletion_bot
   ...botHelpers_useViewerCanAccessPrivateBot
 }
 
@@ -221,35 +359,68 @@
       hasPreviousPage
       startCursor
     }
     id
   }
 }
 
-fragment ChatPageRateLimitedBanner_messageLimit on MessageLimit {
-  numMessagesRemaining
+fragment ChatPageRateLimitedBanner_bot on Bot {
+  messageLimit {
+    numMessagesRemaining
+    dailyLimit
+  }
+  ...subscriptionHelpers_useBotLogData_bot
 }
 
 fragment ChatPageShareFooter_chat on Chat {
   chatId
 }
 
+fragment ChatStopMessageButton_edges on MessageEdge {
+  node {
+    id
+    messageId
+    linkifiedText
+    state
+    text
+    ...useIsMessageCancelled_message
+  }
+}
+
 fragment ChatSubscriptionPaywallContextWrapper_chat on Chat {
   defaultBotObject {
     messageLimit {
       numMessagesRemaining
       shouldShowRemainingMessageCount
+      dailyLimit
     }
-    ...SubscriptionPaywallModal_bot
+    ...ChatSubscriptionPaywallModal_bot
+    ...WebSubscriptionAnnouncementModalOpener_bot
+    ...subscriptionHelpers_useBotLogData_bot
     id
   }
 }
 
+fragment ChatSubscriptionPaywallMain_bot on Bot {
+  ...BotImage_bot
+  ...MessageLimitInfo_bot
+  ...IneligibleForWebSubscription_bot
+  ...subscriptionHelpers_useBotLogData_bot
+}
+
+fragment ChatSubscriptionPaywallModal_bot on Bot {
+  ...ChatSubscriptionPaywallMain_bot
+}
+
 fragment ChatWelcomeView_ChatWelcomeButton_chat on Chat {
   ...chatHelpers_useSendMessage_chat
+  defaultBotObject {
+    nickname
+    id
+  }
 }
 
 fragment ChatWelcomeView_chat on Chat {
   ...ChatWelcomeView_ChatWelcomeButton_chat
   defaultBotObject {
     displayName
     id
@@ -257,14 +428,22 @@
 }
 
 fragment IdAnnotation_node on Node {
   __isNode: __typename
   id
 }
 
+fragment IneligibleForWebSubscription_bot on Bot {
+  messageLimit {
+    numMessagesRemaining
+  }
+  ...BotImage_bot
+  ...MessageLimitInfo_bot
+}
+
 fragment MarkdownLinkInner_chat on Chat {
   id
   chatId
   defaultBotObject {
     nickname
     id
   }
@@ -292,32 +471,48 @@
 }
 
 fragment MessageFeedbackReasonModal_message on Message {
   id
   messageId
 }
 
-fragment SubscriptionPaywallModal_bot on Bot {
+fragment MessageLimitInfo_bot on Bot {
   displayName
   messageLimit {
     dailyLimit
     numMessagesRemaining
     shouldShowRemainingMessageCount
     resetTime
   }
   ...BotImage_bot
 }
 
+fragment UserHandle_user on PoeUser {
+  profilePhotoUrl(size: small)
+  fullName
+  handle
+  ...IdAnnotation_node
+}
+
+fragment WebSubscriptionAnnouncementModalOpener_bot on Bot {
+  id
+  isSystemBot
+  messageLimit {
+    dailySent
+  }
+}
+
 fragment botHelpers_useDeletion_bot on Bot {
   deletionState
 }
 
 fragment botHelpers_useViewerCanAccessPrivateBot on Bot {
   isPrivateBot
   viewerIsCreator
+  isSystemBot
 }
 
 fragment chatHelpers_isBotMessage on Message {
   ...chatHelpers_isHumanMessage
   ...chatHelpers_isChatBreak
 }
 
@@ -352,17 +547,22 @@
 }
 
 fragment chatHelpers_useTimeoutLevel on Message {
   id
   state
   text
   messageId
-  chat {
-    chatId
-    defaultBotNickname
+  author
+}
+
+fragment chatHelpers_useTimeoutLevel_chat on Chat {
+  chatId
+  defaultBotObject {
+    messageTimeoutSecs
+    nickname
     id
   }
 }
 
 fragment chatHelpers_useUpdateStaleChat_chat on Chat {
   chatId
   defaultBotObject {
@@ -372,7 +572,27 @@
   ...chatHelpers_useSendChatBreak_chat
 }
 
 fragment chatHelpers_useUpdateStaleChat_message on Message {
   creationTime
   ...chatHelpers_isChatBreak
 }
+
+fragment inputHelpers_useIsBotResponding_message on Message {
+  author
+  state
+  ...useIsMessageCancelled_message
+}
+
+fragment subscriptionHelpers_useBotLogData_bot on Bot {
+  nickname
+  displayName
+  messageLimit {
+    numMessagesRemaining
+  }
+}
+
+fragment useIsMessageCancelled_message on Message {
+  state
+  linkifiedTextLengthOnCancellation
+  textLengthOnCancellation
+}
```

## poe_graphql/PoeBotCreateMutation.graphql

```diff
@@ -21,17 +21,15 @@
       ...BotHeader_bot
     }
   }
 }
 
 fragment BotHeader_bot on Bot {
   displayName
-  messageLimit {
-    dailyLimit
-  }
+  isLimitedAccess
   ...BotImage_bot
   ...BotLink_bot
   ...IdAnnotation_node
   ...botHelpers_useViewerCanAccessPrivateBot
   ...botHelpers_useDeletion_bot
 }
 
@@ -66,8 +64,9 @@
 fragment botHelpers_useDeletion_bot on Bot {
   deletionState
 }
 
 fragment botHelpers_useViewerCanAccessPrivateBot on Bot {
   isPrivateBot
   viewerIsCreator
+  isSystemBot
 }
```

## poe_graphql/SendMessageMutation.graphql

```diff
@@ -1,15 +1,17 @@
 mutation chatHelpers_sendMessageMutation_Mutation(
   $chatId: BigInt!
   $bot: String!
   $query: String!
   $source: MessageSource
   $withChatBreak: Boolean!
+  $clientNonce: String
+  $sdid: String
 ) {
-  messageEdgeCreate(chatId: $chatId, bot: $bot, query: $query, source: $source, withChatBreak: $withChatBreak) {
+  messageEdgeCreate(chatId: $chatId, bot: $bot, query: $query, source: $source, withChatBreak: $withChatBreak, clientNonce: $clientNonce, sdid: $sdid) {
     chatBreak {
       cursor
       node {
         id
         messageId
         text
         author
@@ -25,16 +27,25 @@
         id
         messageId
         text
         author
         suggestedReplies
         creationTime
         state
+        clientNonce
+        contentType
         chat {
           shouldShowDisclaimer
           id
         }
       }
       id
     }
+    bot {
+      id
+      messageLimit {
+        dailySent
+      }
+    }
+    status
   }
 }
```

## Comparing `poe_api-0.4.3.dist-info/LICENSE` & `poe_api-0.4.4.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `poe_api-0.4.3.dist-info/METADATA` & `poe_api-0.4.4.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: poe-api
-Version: 0.4.3
+Version: 0.4.4
 Summary: A reverse engineered API wrapper for Quora's Poe
 Home-page: https://github.com/ading2210/poe-api
 Author: ading2210
 License: GPLv3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: GNU General Public License (GPL)
@@ -33,14 +33,16 @@
     + [Creating New Bots](#creating-new-bots)
     + [Editing a Bot](#editing-a-bot)
     + [Sending Messages](#sending-messages)
     + [Clearing the Conversation Context](#clearing-the-conversation-context)
     + [Downloading Conversation History](#downloading-conversation-history)
     + [Deleting Messages](#deleting-messages)
     + [Purging a Conversation](#purging-a-conversation)
+    + [Purging All Conversations](#purging-all-conversations)
+    + [Getting the Remaining Messages](#getting-the-remaining-messages)
   * [Misc](#misc)
     + [Changing the Logging Level](#changing-the-logging-level)
     + [Setting a Custom User-Agent](#setting-a-custom-user-agent)
     + [Setting a Custom Device ID](#setting-a-custom-device-id)
 - [Copyright](#copyright)
   * [Copyright Notice](#copyright-notice)
 
@@ -147,14 +149,19 @@
     }
   ],
   "end_cursor": "1000172"
 }
 """
 ```
 
+To get a specific third party bot, you can use `client.get_bot_by_codename`, which accept's the bot's codename as its only argument.
+```python
+client.get_bot_by_codename("JapaneseTutor")
+```
+
 Since display names are the same as the codenames for custom bots, you can simply pass the bot's display name into `client.send_message` to send it a message.
 
 #### Creating New Bots:
 You can create a new bot using the `client.create_bot` function, which accepts the following arguments:
  - `handle` - The handle of the new bot.
  - `prompt = ""` - The prompt for the new bot.
  - `base_model = "chinchilla"` - The model that the new bot uses. This must be either `"chinchilla"` (ChatGPT)  or `"a2"` (Claude).
@@ -292,20 +299,32 @@
 #purge just the last 10 messages
 client.purge_conversation("capybara", count=10)
 
 #purge the entire conversation
 client.purge_conversation("capybara")
 ```
 
+#### Purging All Conversations:
+To purge every conversation in your account, use the `client.purge_all_conversations` function. This function doesn't need any arguments.
+
+```python
+>>> client.purge_all_conversations()
+```
+
 #### Getting the Remaining Messages:
 To get the number of messages remaining in the quota for a conversation, use the `client.get_remaining_messages` function. This function accepts the following arguments:
  - `chatbot` - The codename of the chatbot.
 
 The function will return the number of messages remaining, or `None` if the bot does not have a quota.
 
+```python
+>>> client.get_remaining_messages("beaver")
+1
+```
+
 ### Misc:
 #### Changing the Logging Level:
 If you want to show debug messages, simply call `poe.logger.setLevel`.
 
 ```python
 import poe
 import logging
```

